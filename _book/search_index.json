[
["index.html", "Similitud de Comunidades biológicas Prefacio", " Similitud de Comunidades biológicas Carlos Iván Espinosa Octubre 2016 Prefacio La comunidad biológica se refiere a una agrupación de poblaciones de especies que se presentan juntas en el espacio y el tiempo (Begon et al. 1999). Este concepto plantea que las comunidades tienen unos límites en el espacio y el tiempo, y que estos límites están dados por la distribución de las poblaciones. Sin embargo, la distribución de las poblaciones no es homogénea y cada población responde diferente en el espacio y el tiempo. Estas respuestas diferenciadas de cada población y de la comunidad en general genera la zonación y la sucesión respectivamente. La identificación de los las diferentes formaciones biológicas en el espacio (Zonación) o definir las etapas seriales a lo largo del tiempo (sucesión) implica que tenemos la capacidad de establecer en que momento una comunidad cambia. Parece una tarea sencilla, pero realmente no lo es, ¿cuanto deberia cambiar una comunidad para poder hablar de etapas seriales o zonas distintas? y ¿cómo podemos calcular ese cambio? Una de las formas de responder estas preguntas puede ser intentar cuantificar las similitudes entre localidades. "],
["objetivos.html", "Objetivos", " Objetivos En este ejercicio mostramos las bases del calculo cálculo de similitudes entre comunidades, el cual se convierte en la base de los análisis multivariantes de la comunidad. Específicamente nos interesa; Comprender las bases teóricas para el cálculo de similitudes de la estructura de la comunidad entre localidades. Utilizar herramientas de análisis para calcular índices de similitud y distancias entre comunidades Stenocercus iridicens "],
["introduccion.html", "Capítulo 1 Introducción 1.1 Similitud basada en la distancia 1.2 Similitud", " Capítulo 1 Introducción 1.1 Similitud basada en la distancia “La abundancia se refiere al número de individuos de una especie en una determinada área” — (Smith and Smith 2010) Cuando hablamos de la composición de especies de una comunidad nos referimos al conjunto de especies que habitan una determinada localidad. Típicamente, esto incluye cierto grado de abundancia de cada especie, pero puede también ser simplemente un listado de especies en esa localidad, donde se registra la presencia o ausencia de cada especie. Ahora, imaginemos que tenemos cuatro localidades (A, B, C, D) donde recogemos los datos de densidad de dos especies; Tabebuia billbergii y Geofroea spinosa, especies características de bosques secos tropicales. Podemos introducir datos hipotéticos de abundancia para cada especie en cada una de las localidades. dens &lt;- data.frame(T.bil = c(1, 1, 2, 3), G.spi = c(21, 8, 13, 5)) row.names(dens) &lt;- LETTERS[1:4] dens ## T.bil G.spi ## A 1 21 ## B 1 8 ## C 2 13 ## D 3 5 Generamos un gráfico para ver cuánto se parece cada sitio (Figura 1.1) par(mar=c(4,4,1,1), mgp=c(1,0.3,0), tcl= -0.2) plot(dens, type = &quot;n&quot;, cex.axis=0.8, xlim=c(0,20)) text(dens, row.names(dens), col =&quot;blue&quot;) Figure 1.1: Distancias de cuatro localidades hipotéticas En la figura 1.1 vemos que la composición de especies en el sitio A es diferente de la composición del sitio D. Es decir, la distancia entre el sitio A y D es mayor que entre los otros sitios. Lo siguiente que nos deberíamos preguntar es; ¿qué tan distantes están los dos sitios? Claramente, esto depende de la escala de medición (los valores de los ejes), y sobre cómo medimos la distancia a través del espacio multivariado (Stevens 2009). Estas diferencias entre sitios son dependientes de la abundancia de cada especie. En el caso de G. spinosa su eje varía entre 5 y 21, mientras que para T. billbergii varía entre 1 y 3. Veamos ahora que sucede con las similitud si incremento la abundancia de T. billbergii. par(mar=c(4,4,1,1), mgp=c(1,0.3,0), tcl= -0.2) dens1 &lt;- dens dens1$T.bil &lt;- dens1$T.bil*100 plot(dens1, type = &quot;n&quot;, cex.axis=0.8, ylim=c(0,300)) text(dens1, row.names(dens1), col =&quot;blue&quot;) Figure 1.2: Distancias de cuatro localidades hipotéticas Como vemos en la figura 1.2 las distancias entre cada uno de los sitios cambio, aunque la comunidad se mantuvo igual. Una forma de corregir esta distorsión es calcular la densidad relativa de cada especie, de esta forma cada especie variará entre 0 y 1 (Stevens 2009). Cuando nos referimos a densidad relativa hablamos de la densidad de una especie con referencia a algo, en relación a la abundancia de individuos de la misma especie en otros sitios. Para calcular la densidad relativa dividimos la abundancia de cada especie para la suma total de los individuos de las especies en esa muestra. dens[,1]/sum(dens[,1]) ## [1] 0.1428571 0.1428571 0.2857143 0.4285714 dens1[,1]/sum(dens1[,1]) ## [1] 0.1428571 0.1428571 0.2857143 0.4285714 Ahora podemos ver cómo T. billbergii varía en su abundancia en los cuatro sitios. El sitio A y B tienen el 14% de individuos mientras que el D tiene el 42% de los individuos de esta especie. Interesantemente, no hay diferencias en las proporciones entre las dos medidas que tenemos. ¿Qué pasó con las distancias? dens3 &lt;- dens for(i in 1:2){ dens3[,i] &lt;- dens[,i]/sum(dens[,i]) } dens4 &lt;- dens1 for(i in 1:2){ dens4[,i] &lt;- dens1[,i]/sum(dens1[,i]) } par(mfcol=c(2,2), mar=c(4,4,1,1), mgp=c(1,0.3,0), tcl= -0.2) plot(dens, type = &quot;n&quot;, cex.axis=0.8, xlim=c(0,20), main = &quot;Densidad&quot;) text(dens, row.names(dens), col =&quot;blue&quot;) plot(dens1, type = &quot;n&quot;, cex.axis=0.8, ylim=c(0,300), main = &quot;Densidad 2&quot;) text(dens1, row.names(dens1), col =&quot;blue&quot;) plot(dens3, type = &quot;n&quot;, cex.axis=0.8, main = &quot;Densidad relativa&quot;) text(dens3, row.names(dens3), col =&quot;blue&quot;) plot(dens4, type = &quot;n&quot;, cex.axis=0.8, main = &quot;Densidad relativa2&quot;) text(dens4, row.names(dens4), col =&quot;blue&quot;) Figure 1.3: Distancias de cuatro localidades hipotéticas En la figura 1.3 podemos apreciar que no hay diferencias entre las dos densidades cuando estoy usando la densidad relativa. Pero ¿Qué implicaciones biológicas tiene el usar las densidades relativas para calcular la distancia entre sitios? Cuando usamos las densidades relativas lo que estamos haciendo es darles el mismo peso a tods las especies, de esta manera si yo tengo un ecosistema con una especie dominante y varias subordinadas, al usar la densidad relativa estoy eliminando esa dominancia. Es importante que tener claro este punto ya que las interpretaciones que puedo hacer con los datos de densidad y densidad relativa son distintos. Ya sea que nuestras medidas de abundancia son absoluta o relativa, nos interesa conocer cuan diferente es la comunidad de una muestra (o sitio) con relación a la otra. En el ejemplo ha sido fácil entender la diferencia entre las dos comunidades debido a que teníamos únicamente dos especies, pero con más de tres especies es complicado observar estas diferencias gráficamente. Tal vez la forma más sencilla de describir la diferencia entre los sitios es calcular las distancias entre cada par de sitios. 1.1.1 Distancias entre sitios La distancia entre dos muestras está dada por la diferencia entre la abundancia y la composición de especies, como lo hemos visto esto genera una distancia, en el caso del ejemplo la comunidad A esta más alejada de la comunidad D que de las otras dos. Existen muchas formas de poder calcular las distancias entre estos puntos una de las más sencillas es la distancia Euclidiana. La distancia euclidiana entre dos sitios es simplemente la longitud del vector que conecta los sitios y la podemos obtener como \\(\\sqrt{x^2+y^2}\\), donde “x” y “y” son las coordenadas (x, y) de distancia entre un par de sitios. En nuestro caso si queremos comparar B y C tenemos que la distancia en el eje x es la diferencia de la abundancia de T. bilbergii entre el sitio B y C. x &lt;- dens[2, 1] - dens[3, 1] Mientras que la distancia en el eje y es la diferencia en la abundancia de G. spinosa entre el sitio B y C. y &lt;- dens[2, 2] - dens[3, 2] Ahora obtenemos las distancias entre los dos sitios sqrt(x^2 + y^2) ## [1] 5.09902 Pero como en R todo es sencillo podemos utilizar la función dist dist(dens) ## A B C ## B 13.000000 ## C 8.062258 5.099020 ## D 16.124515 3.605551 8.062258 Si bien este cálculo es sencillo con dos especies, si tenemos que calcular la distancia para una comunidad con más de tres especies los cálculos son tediosos y largos. Para calcular la distancia Euclidiana entre pares de sitios con R especies utilizamos la siguiente ecuación: \\[D_E = \\sqrt{\\sum_{i=l}^R (x_{ai} - x_{bi})^2}\\] Distancia Euclidiana Existen otras formas de medir distancias entre dos localidades. En ecología una de las distancias más utilizada es la distancia de Bray-Curtis, conocida también como Sorensen. Esta distancia es calculada como: \\[D_{BC} = \\sum_{i=l}^R \\frac{(x_{ai} - x_{bi})}{(x_{ai} + x_{bi})}\\] Distancia de Bray-Curtis La distancia Bray-Curtis no es más que la diferencia total en la abundancia de especies entre dos sitios, dividido para la abundancia total en cada sitio. La distancia Bray-Curtis tiende a resultar más intuitiva debido a que las especies comunes y raras tienen pesos relativamente similares, mientras que la distancia euclidia depende en mayor medida de las especies más abundantes. Esto sucede porque las distancias euclidianas se basan en diferencias al cuadrado, mientras que Bray-Curtis utiliza diferencias absolutas. El elevar un número al cuadrado siempre amplifica la importancia de los valores más grandes. En la figura 1.4 se compara gráficos basados en distancias euclidianas y Bray-Curtis de los mismos datos. Como se había comentado es virtualmente imposible representar una distancia en más de tres dimensiones (cada especie es una dimensión). Una forma sencilla de mostrar distancias para tres o más especies es crear un gráfico de dos dimensiones, intentando organizar todos los sitios para que las distancias sean aproximadamente las correctas. Está claro que esto es una aproximación nunca estas serán exactas. Una técnica que intenta crear un arreglo aproximado es escalamiento multidimensional no métrico (NMDS). Vamos a calcular las distancias para nuestra comunidad, primero vamos a añadir dos especies más a nuestra comunidad, Ceiba trichistandra y Colicodendron scabridum. dens$C.tri&lt;- c(11, 3, 7, 5) dens$C.sca&lt;- c(16, 0, 9, 4) La función de escalamiento multidimensional no-métrico está en el paquete vegan. Aquí mostramos las distancias euclidianas entre sitios (Figura 1.4a) y las distancias de Bray-Curtis (Figura 1.4b). library(vegan) #Distancia Euclidiana mdsE &lt;- metaMDS(dens, distance = &quot;euc&quot;, autotransform = FALSE, trace = 0) #Distancia de Bray-Curtis mdsB &lt;- metaMDS(dens, distance = &quot;bray&quot;, autotransform = FALSE, trace = 0) par(mfcol=c(1,2), oma=c(1,1,1,1), mar=c(4,4,1,1), mgp=c(1,0.3,0), tcl= -0.2) plot(mdsE, display = &quot;sites&quot;, type = &quot;text&quot;,main=&quot;a)Euclidiana&quot;, cex.axis= 0.7, cex.main=0.75, cex.lab=0.7) plot(mdsB, display = &quot;sites&quot;, type = &quot;text&quot;, main=&quot;b)Bray-Curtis&quot;, cex.axis= 0.7, cex.main=0.75, cex.lab=0.7) Figure 1.4: Arreglo de las parcelas en distancias multidimensionales no métricas (NMDS). Estas dos figuras muestran los mismos datos en bruto, pero las distancias euclidianas tienden a enfatizar las diferencias debidas a las especies más abundantes, mientras que Bray-Curtis no lo hace. 1.2 Similitud Ahora que sabemos cuan distantes son los diferentes sitios, muchas veces nos podría interesar cuan similares son cada uno de los sitios a continuación se describen dos medidas de similitud; Porcentaje de Similitud e Índice de Sorensen. El porcentaje de similitud puede ser simplemente la suma de los porcentajes mínimos de cada especie en la comunidad. Lo primero que debemos hacer es convertir la abundancia de cada especie a su abundancia relativa dentro de cada sitio. Para ello dividimos la abundancia de cada especie por la suma de las abundancias en cada sitio. dens.RA &lt;- t(apply(dens, 1, function(sp.abun) sp.abun/sum(sp.abun))) dens.RA ## T.bil G.spi C.tri C.sca ## A 0.02040816 0.4285714 0.2244898 0.3265306 ## B 0.08333333 0.6666667 0.2500000 0.0000000 ## C 0.06451613 0.4193548 0.2258065 0.2903226 ## D 0.17647059 0.2941176 0.2941176 0.2352941 El siguiente paso para comparar entre sitios, es encontrar el valor mínimo para cada especie entre los sitios que debemos comparar. Vamos a comparar los sitios A y B, para esto utilizamos la función aplly, la cual nos permite encontrar el valor mínimo entre las filas 1 y 2 (sitio A y B respectivamente). Para T. billbergi en el sitio A la abundancia relativa es 0.02 que es menor a la abundancia en el sitio B que es de 0.08. mins &lt;- apply(dens.RA[1:2, ], 2, min) mins ## T.bil G.spi C.tri C.sca ## 0.02040816 0.42857143 0.22448980 0.00000000 Finalmente para conocer el porcentaje de similitud entre los dos sitios sumamos estos valores y multiplicamos por 100. sum(mins)*100 ## [1] 67.34694 Esto significa que la comunidad A y B tienen un porcentaje de similitud del 67%. El índice de Sorensen es la segunda medida de similitud que vamos a estudiar, este índice es medido como: \\[S_s= \\frac{(2C)}{(A+B)}\\] Índice de Sorensen Donde C es el número de especies en común entre los dos sitios, y A y B son el número de especies en cada sitio. Esto es equivalente a dividir las especies compartidas por la riqueza media. Para calcular el índice de Sorensen entre los sitios A y B necesitamos definir el número de especies compartidas y luego la riqueza de cada uno de los dos sitios. Definimos si alguna de las especies en uno de los sitios la abundancia no es igual a cero, eso nos dirá en qué casos se comparten especies. Finalmente, sumamos todas las especies que su abundancia es mayor a cero. comp&lt;- apply(dens[1:2, ], 2, function(abuns) all(abuns != 0)) comp ## T.bil G.spi C.tri C.sca ## TRUE TRUE TRUE FALSE Rs &lt;- apply(dens[1:2, ], 1, function(x) sum(x &gt; 0)) Rs ## A B ## 4 3 Como vemos, la abundancia de C. scabridum en uno de los dos sitios es igual a Cero, lo confirmamos al tener la riqueza por sitio. El sitio B tenemos únicamente 3 especies. Ahora aplicamos la formula, dividimos las especies compartidas (comp) para la riqueza total de los dos sitios y lo multiplicamos por 2. (2*sum(comp))/sum(Rs) ## [1] 0.8571429 Según el índice de Sorensen estos dos sitios son parecidos en un 86%. Los datos de los dos índices utilizados difieren entre sí, el porcentaje de similitud utiliza no solamente la presencia ausencia sino también la abundancia lo que podría estar reduciendo la similitud entre sitios. La distancia de Bray Curtis y el índice de Sorensen tienen una base conceptual similar, la diferencia es que Bray-Curtis se basa en datos de abundancias y Sorensen en datos de presencia ausencia. Muchas veces se utilizan como sinónimos aunque se especifíca si esta basado en abundancias o en presencia-ausencia. References "],
["ejercicio-practico.html", "Capítulo 2 Ejercicio práctico 2.1 Enunciado", " Capítulo 2 Ejercicio práctico 2.1 Enunciado Una de las preguntas básicas de un ecólogo es saber ¿Cómo de diferentes son dos comunidades?. Como hemos visto en el capítulo anterior existen varias decisiones que los investigadores debemos tomar, estas decisiones afectan directamente a los resultados que podemos obtener y por ende a las conclusiones biológicas que obtenemos de este análisis. El presente ejercicio evaluaremos como las diferentes desiciones que tomamos entorno al procesamiento de datos afectan nuestras medidas de similitud, y cuales son las conclusiones biológicas que obtenemos con uno u otro procedimiento. En la tabla 2.1 mostramos cinco comunidades hipotéticas. Table 2.1: Comunidades hipotéticas sp1 sp2 sp3 sp4 sp5 sp6 sp7 sp8 A 26 17 16 1995 159 0 362 0 B 0 35 14 236 54 0 496 57 C 24 0 26 17 88 18 907 20 D 35 18 24 2033 175 15 376 16 E 105 129 40 18 191 53 964 134 Con los datos anteriores: Convierta los datos en abundancia relativa por especie (la suma en cada especie debe ser igual a 1). Dibuje dos gráficas para representar; i) la abundancia total y ii) abundancia relativa de cada localidad. ¿Qué diferencias puede ver en la gráfica i y en la ii?¿Qué implicaciones biológicas podría tener si utilizamos la primera o la segunda matriz para calcular las similitudes? Calcule la distancia Euclideana y de Bray Curtis para cada sitio con las dos medidas de abundancia y grafíquelas utilizando el NMDS. ¿Cómo cambia entre distancias y abundancias? ¿Por qué se dan estas diferencias? ¿Puede darle una explicación biológica a los diferentes resultados? Evalúe la similitud (Sorensen) y el porcentaje de similitud entre pares de sitios. ¿Cuáles son los sitios más similares? ¿Cuál es la razón de las diferencias entre los índices utilizados? ¿De una interpretación biológica a estos resultados? "]
]
